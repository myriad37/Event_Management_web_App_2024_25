(()=>{"use strict";var e=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function c(e){try{s(o.next(e))}catch(e){i(e)}}function a(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}s((o=o.apply(e,t||[])).next())}))};const t="http://localhost:3000/";function n(n,o){return e(this,void 0,void 0,(function*(){try{const e=yield fetch(`${t}${n}`,{headers:{Authorization:`Bearer ${o}`}});return e.ok?{success:!0,data:yield e.json()}:{success:!1,error:yield e.json()}}catch(e){return console.error("Error fetching data from API",e),{success:!1,error:{message:"An error occurred while fetching data."}}}}))}function o(n,o,r){return e(this,void 0,void 0,(function*(){try{const e=yield fetch(`${t}${n}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:o?JSON.stringify(o):void 0});return e.ok?{success:!0,data:yield e.json()}:{success:!1,error:yield e.json()}}catch(e){return console.error("Error posting data to API",e),{success:!1,error:{message:`An error occurred while connecting to the API: ${e.message||"Unknown error"}`}}}}))}const r=(e="token")=>{return t=void 0,n=void 0,i=function*(){const t=localStorage[e];if(t)try{const e=yield function(e,t="auth/validate"){return n=this,r=void 0,c=function*(){const n={token:e};return yield o(t,n)},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{s(c.next(e))}catch(e){t(e)}}function a(e){try{s(c.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,a)}s((c=c.apply(n,r||[])).next())}));var n,r,i,c}(t);return!0===e.success?!0===(yield e.data).valid:(console.error("Error validating token:",e.error),!1)}catch(e){return console.error("Error validating token:",e),!1}return!1},new((r=void 0)||(r=Promise))((function(e,o){function c(e){try{s(i.next(e))}catch(e){o(e)}}function a(e){try{s(i.throw(e))}catch(e){o(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(c,a)}s((i=i.apply(t,n||[])).next())}));var t,n,r,i};var i=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function c(e){try{s(o.next(e))}catch(e){i(e)}}function a(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}s((o=o.apply(e,t||[])).next())}))};const c=(e,t,n)=>{const o=document.createElement("a");return o.classList.add("block","px-4","py-2","text-sm","text-gray-700"),o.setAttribute("href",t),o.setAttribute("role","menuitem"),o.setAttribute("tabindex","-1"),o.setAttribute("id",n),o.innerText=e,o},a=()=>i(void 0,void 0,void 0,(function*(){const e=localStorage.getItem("token"),t=yield function(e){return t=this,o=void 0,i=function*(){return yield n("user",e)},new((r=void 0)||(r=Promise))((function(e,n){function c(e){try{s(i.next(e))}catch(e){n(e)}}function a(e){try{s(i.throw(e))}catch(e){n(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(c,a)}s((i=i.apply(t,o||[])).next())}));var t,o,r,i}(e);if(t.success){const e=t.data;if(e&&"admin"===e.role)return!0}return!1})),s=()=>i(void 0,void 0,void 0,(function*(){localStorage.removeItem("token"),window.location.href="/account/login.html"}));var u=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function c(e){try{s(o.next(e))}catch(e){i(e)}}function a(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}s((o=o.apply(e,t||[])).next())}))};function d(e){e.innerHTML=""}function l(e){return{isValid:/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(e),error:"Invalid email address"}}function m(e){return{isValid:e.length>6,error:"Password must be at least 6 characters"}}const f=function(e,t){const n=[],o=l("test@example.com");n.push(o);const r=m("password123");return n.push(r),n}();console.log("Login Form Validation Results:",f);const h=function(e,t,n){const o=[],r=l("newuser@example.com");o.push(r);const i=m("securePassword123");o.push(i);const c={isValid:""!=="securePassword1234".trim(),error:"This field is required"};return o.push(c),o}();console.log("Registration Form Validation Results:",h);var v=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function c(e){try{s(o.next(e))}catch(e){i(e)}}function a(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}s((o=o.apply(e,t||[])).next())}))};document.addEventListener("DOMContentLoaded",(e=>v(void 0,void 0,void 0,(function*(){i(void 0,void 0,void 0,(function*(){const e=document.querySelector("#user-menu-list");if(e)if(e.innerHTML="",yield r()){const t=window.location.pathname.includes("login.html"),n=window.location.pathname.includes("signup.html");let o;o=(yield a())?"/admin":"/user",(t||n)&&(window.location.href=o),e.appendChild(c("Your Dashboard",o,"user-menu-item-0")),e.appendChild(c("Logout","account/login.html","user-menu-item-2"));const r=document.querySelector("#user-menu-item-2");r&&r.addEventListener("click",(e=>{e.preventDefault(),s()}))}else document.querySelectorAll(".login-required").forEach((e=>{e.setAttribute("href","/account/login.html")})),e.appendChild(c("Sign In","/account/login.html","user-menu-item-0")),e.appendChild(c("Create Account","/account/signup.html","user-menu-item-1"))})),(()=>{const e=document.querySelector("#user-menu"),t=document.querySelector("#user-menu-list");e&&t&&e.addEventListener("click",(()=>{t.classList.toggle("hidden")}));const n=document.querySelector("#mobile-menu"),o=document.querySelector("#menu-toggle"),r=document.querySelector("#menu-close-btn"),i=document.querySelector("#menu-show-btn");o&&n&&r&&i&&o.addEventListener("click",(()=>{n.classList.toggle("hidden"),r.classList.toggle("hidden"),i.classList.toggle("hidden")}))})();const e=new URLSearchParams(window.location.search).get("id");if(!e)return void(window.location.href="/events.html");const t=yield function(e){return u(this,void 0,void 0,(function*(){return yield n(`event/${e}`)}))}(parseInt(e));if(!1===t.success)return void(window.location.href="/events.html");const l=document.getElementById("eventTitle"),m=document.getElementById("eventDescription"),f=document.getElementById("eventLocation"),h=document.getElementById("eventDate"),y=document.getElementById("confirmBooking");l.classList.add("text-2xl","font-bold","tracking-tight","text-gray-900","dark:text-white"),m.classList.add("text-sm","text-gray-500","dark:text-gray-400","font-semibold"),f.classList.add("text-sm","text-gray-500","dark:text-gray-400","font-semibold"),h.classList.add("text-sm","text-gray-500","dark:text-gray-400","font-semibold"),y.classList.add("bg-blue-500","hover:bg-blue-700","text-white","font-bold","py-2","px-4","rounded"),l.textContent=t.data.eventName,m.textContent=t.data.description,f.textContent=t.data.location,h.textContent=function(e,t=!1){const n=new Date(e);let o;return o=t?new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric"}).format(n):new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}).format(n),o}(t.data.eventDate),y.addEventListener("click",(e=>v(void 0,void 0,void 0,(function*(){e.preventDefault();const n=localStorage.getItem("token");if(!n)return void(window.location.href="/account/login.html");const r=yield function(e,t){return u(this,void 0,void 0,(function*(){return yield o(`event/${e}/book`,void 0,t)}))}(t.data.id,n);if(!0===r.success)return(i=document.querySelector("#errorContainer")).innerHTML='<div class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4" role="alert">\n    <p class="font-bold">Success</p>\n    <p>You have successfully booked this event. You will be redirected to your bookings in 3 seconds.</p>\n  </div>',setTimeout((()=>d(i)),3e3),void setTimeout((()=>{window.location.href="/bookings/?id="+r.data.id}),3e3);var i;const c=r.error.message,a=document.querySelector("#errorContainer");a&&function(e,t,n){e.innerHTML=`<div class="bg-orange-100 border-l-4 border-orange-500 text-orange-700 p-4" role="alert">\n    <p class="font-bold">Error</p>\n    <p>${t}</p>\n  </div>`,setTimeout((()=>d(e)),3e3)}(a,c)}))))}))))})();